{"links": {"self": {"href": "data/repositories/osrf/handsim/issues/18/comments/16895653.json"}, "html": {"href": "#!/osrf/handsim/issues/18#comment-16895653"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/handsim/issues/18.json"}}, "type": "issue", "id": 18, "repository": {"links": {"self": {"href": "data/repositories/osrf/handsim.json"}, "html": {"href": "#!/osrf/handsim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{9c7d89af-6eb6-40b1-9f69-da1ae9d129ce}ts=c_plus_plus"}}, "type": "repository", "name": "handsim", "full_name": "osrf/handsim", "uuid": "{9c7d89af-6eb6-40b1-9f69-da1ae9d129ce}"}, "title": "Joint velocity jitter/nonzero at rest"}, "content": {"raw": "I've started looking into this @hsu . Putting aside sensor noise, I started looking at the [LinkData](https://bitbucket.org/osrf/gazebo/src/daceef4a9afcd72016b1eb8acb5eaf1a8f15ef57/gazebo/physics/Link.cc#cl-999) topics, and there is some definite funny business there. This topic is published in [Link::PublishData](https://bitbucket.org/osrf/gazebo/src/daceef4a9afcd72016b1eb8acb5eaf1a8f15ef57/gazebo/physics/Link.cc#cl-999) and includes the world frame linear and angular velocity.\n\nWith PID controllers active and the hand in a steady-state position, I tried echoing the topic, and I found that there was a steady non-zero value of the linear z velocity, even when the hand was at rest:\n~~~\n$ gz topic -u -e /gazebo/default/mpl_haptix_right_forearm::middle3 | sed -e 's@angular_velocity.*@@' -e 's@name.* z:@z:@'\ntime { sec: 129 nsec: 726000000 } z: -0.0026262652643209029 } \ntime { sec: 129 nsec: 727000000 } z: -0.0026616112119536759 } \ntime { sec: 129 nsec: 728000000 } z: -0.0026206027668168562 } \ntime { sec: 129 nsec: 729000000 } z: -0.00259639558047889 } \ntime { sec: 129 nsec: 730000000 } z: -0.0026334138411617876 } \ntime { sec: 129 nsec: 731000000 } z: -0.0026595426333755282 } \ntime { sec: 129 nsec: 732000000 } z: -0.0026254448617372226 } \ntime { sec: 129 nsec: 733000000 } z: -0.0026605847443534414 } \ntime { sec: 129 nsec: 734000000 } z: -0.0026194411266903788 } \ntime { sec: 129 nsec: 735000000 } z: -0.002595134210112089 } \ntime { sec: 129 nsec: 736000000 } z: -0.0026321351079882649 } \ntime { sec: 129 nsec: 737000000 } z: -0.0026582218459148877 } \ntime { sec: 129 nsec: 738000000 } z: -0.0026240574611950565 } \ntime { sec: 129 nsec: 739000000 } z: -0.0026591816583280171 } \ntime { sec: 129 nsec: 740000000 } z: -0.0026180493601144234 } \ntime { sec: 129 nsec: 741000000 } z: -0.0025937628291408709 } \ntime { sec: 129 nsec: 742000000 } z: -0.002630851101194564 } \n~~~\n\nI'm guessing that we are getting a velocity corresponding to the wrong half of the split impulse calculation.", "markup": "markdown", "html": "<p>I've started looking into this @hsu . Putting aside sensor noise, I started looking at the <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/gazebo/src/daceef4a9afcd72016b1eb8acb5eaf1a8f15ef57/gazebo/physics/Link.cc#cl-999\" rel=\"nofollow\">LinkData</a> topics, and there is some definite funny business there. This topic is published in <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/gazebo/src/daceef4a9afcd72016b1eb8acb5eaf1a8f15ef57/gazebo/physics/Link.cc#cl-999\" rel=\"nofollow\">Link::PublishData</a> and includes the world frame linear and angular velocity.</p>\n<p>With PID controllers active and the hand in a steady-state position, I tried echoing the topic, and I found that there was a steady non-zero value of the linear z velocity, even when the hand was at rest:</p>\n<div class=\"codehilite\"><pre><span></span>$ gz topic -u -e /gazebo/default/mpl_haptix_right_forearm::middle3 <span class=\"p\">|</span> sed -e <span class=\"s1\">&#39;s@angular_velocity.*@@&#39;</span> -e <span class=\"s1\">&#39;s@name.* z:@z:@&#39;</span>\n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">726000000</span> <span class=\"o\">}</span> z: -0.0026262652643209029 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">727000000</span> <span class=\"o\">}</span> z: -0.0026616112119536759 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">728000000</span> <span class=\"o\">}</span> z: -0.0026206027668168562 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">729000000</span> <span class=\"o\">}</span> z: -0.00259639558047889 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">730000000</span> <span class=\"o\">}</span> z: -0.0026334138411617876 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">731000000</span> <span class=\"o\">}</span> z: -0.0026595426333755282 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">732000000</span> <span class=\"o\">}</span> z: -0.0026254448617372226 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">733000000</span> <span class=\"o\">}</span> z: -0.0026605847443534414 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">734000000</span> <span class=\"o\">}</span> z: -0.0026194411266903788 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">735000000</span> <span class=\"o\">}</span> z: -0.002595134210112089 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">736000000</span> <span class=\"o\">}</span> z: -0.0026321351079882649 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">737000000</span> <span class=\"o\">}</span> z: -0.0026582218459148877 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">738000000</span> <span class=\"o\">}</span> z: -0.0026240574611950565 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">739000000</span> <span class=\"o\">}</span> z: -0.0026591816583280171 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">740000000</span> <span class=\"o\">}</span> z: -0.0026180493601144234 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">741000000</span> <span class=\"o\">}</span> z: -0.0025937628291408709 <span class=\"o\">}</span> \n<span class=\"nb\">time</span> <span class=\"o\">{</span> sec: <span class=\"m\">129</span> nsec: <span class=\"m\">742000000</span> <span class=\"o\">}</span> z: -0.002630851101194564 <span class=\"o\">}</span> \n</pre></div>\n\n\n<p>I'm guessing that we are getting a velocity corresponding to the wrong half of the split impulse calculation.</p>", "type": "rendered"}, "created_on": "2015-03-25T19:09:12.836382+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-26T01:07:33.029368+00:00", "type": "issue_comment", "id": 16895653}