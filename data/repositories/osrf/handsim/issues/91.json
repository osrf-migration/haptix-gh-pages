{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/handsim.json"}, "html": {"href": "#!/osrf/handsim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{9c7d89af-6eb6-40b1-9f69-da1ae9d129ce}ts=c_plus_plus"}}, "type": "repository", "name": "handsim", "full_name": "osrf/handsim", "uuid": "{9c7d89af-6eb6-40b1-9f69-da1ae9d129ce}"}, "links": {"attachments": {"href": "data/repositories/osrf/handsim/issues/91/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/handsim/issues/91.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/handsim/issues/91/watch"}, "comments": {"href": "data/repositories/osrf/handsim/issues/91/comments_page=1.json"}, "html": {"href": "#!/osrf/handsim/issues/91/locale-runtime-error-when-using-ogre3d"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/handsim/issues/91/vote"}}, "reporter": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "title": "locale runtime error when using ogre3d package", "component": null, "votes": 0, "watches": 3, "content": {"raw": "While I was using docker to test the handsim package I found that every gazebo command I launch ends up with:\r\n\r\n```\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  locale::facet::_S_create_c_locale name not valid\r\n```\r\n\r\nThe gdb trace points to Ogre\r\n```\r\n(gdb) bt\r\n#0  0x00007ffff28c0cc9 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\r\n#1  0x00007ffff28c40d8 in __GI_abort () at abort.c:89\r\n#2  0x00007ffff31cb6b5 in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#3  0x00007ffff31c9836 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#4  0x00007ffff31c9863 in std::terminate() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#5  0x00007ffff31c9aa2 in __cxa_throw () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#6  0x00007ffff321b677 in std::__throw_runtime_error(char const*) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#7  0x00007ffff31e70c4 in std::locale::facet::_S_create_c_locale(__locale_struct*&, char const*, __locale_struct*) ()\r\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#8  0x00007ffff31dc2e9 in std::locale::_Impl::_Impl(char const*, unsigned long) ()\r\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#9  0x00007ffff31dcd7b in std::locale::locale(char const*) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#10 0x00007fffed4f228e in ?? () from /usr/lib/x86_64-linux-gnu/libOgreMain.so.1.10.0\r\n#11 0x00007ffff7dea13a in call_init (l=<optimized out>, argc=argc@entry=1, argv=argv@entry=0x7fffffffece8, \r\n    env=env@entry=0x7fffffffecf8) at dl-init.c:78\r\n#12 0x00007ffff7dea223 in call_init (env=<optimized out>, argv=<optimized out>, argc=<optimized out>, \r\n    l=<optimized out>) at dl-init.c:36\r\n#13 _dl_init (main_map=0x7ffff7ffe1c8, argc=1, argv=0x7fffffffece8, env=0x7fffffffecf8) at dl-init.c:126\r\n#14 0x00007ffff7ddb30a in _dl_start_user () from /lib64/ld-linux-x86-64.so.2\r\n```\r\n\r\nWhile strace displays information about the system looking for a en_GB locale:\r\n```\r\nlock_getres(CLOCK_REALTIME, {0, 1})    = 0\r\nopen(\"/usr/lib/locale/locale-archive\", O_RDONLY|O_CLOEXEC) = 3\r\nfstat(3, {st_mode=S_IFREG|0644, st_size=2854960, ...}) = 0\r\nmmap(NULL, 2854960, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fa6b5b19000\r\nclose(3)                                = 0\r\nopen(\"/usr/share/locale/locale.alias\", O_RDONLY|O_CLOEXEC) = 3\r\nfstat(3, {st_mode=S_IFREG|0644, st_size=2570, ...}) = 0\r\nmmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fa6dbab9000\r\nread(3, \"# Locale name alias data base.\\n#\"..., 4096) = 2570\r\nread(3, \"\", 4096)                       = 0\r\nclose(3)                                = 0\r\nmunmap(0x7fa6dbab9000, 4096)            = 0\r\nopen(\"/usr/lib/locale/en_GB.UTF-8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/lib/locale/en_GB.utf8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/lib/locale/en_GB/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/lib/locale/en.UTF-8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/lib/locale/en.utf8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/lib/locale/en/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/share/locale-langpack/en_GB.UTF-8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/share/locale-langpack/en_GB.utf8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/share/locale-langpack/en_GB/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/share/locale-langpack/en.UTF-8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/share/locale-langpack/en.utf8/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\nopen(\"/usr/share/locale-langpack/en/LC_CTYPE\", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\r\n```\r\nMy hypothesis is that we should be under the effects of [this problem](http://www.ogre3d.org/forums/viewtopic.php?f=2&t=80132). Official [issue](https://ogre3d.atlassian.net/browse/OGRE-374).", "markup": "markdown", "html": "<p>While I was using docker to test the handsim package I found that every gazebo command I launch ends up with:</p>\n<div class=\"codehilite\"><pre><span></span>terminate called after throwing an instance of &#39;std::runtime_error&#39;\n  what():  locale::facet::_S_create_c_locale name not valid\n</pre></div>\n\n\n<p>The gdb trace points to Ogre</p>\n<div class=\"codehilite\"><pre><span></span>(gdb) bt\n#0  0x00007ffff28c0cc9 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n#1  0x00007ffff28c40d8 in __GI_abort () at abort.c:89\n#2  0x00007ffff31cb6b5 in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#3  0x00007ffff31c9836 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#4  0x00007ffff31c9863 in std::terminate() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#5  0x00007ffff31c9aa2 in __cxa_throw () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#6  0x00007ffff321b677 in std::__throw_runtime_error(char const*) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#7  0x00007ffff31e70c4 in std::locale::facet::_S_create_c_locale(__locale_struct*&amp;, char const*, __locale_struct*) ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#8  0x00007ffff31dc2e9 in std::locale::_Impl::_Impl(char const*, unsigned long) ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#9  0x00007ffff31dcd7b in std::locale::locale(char const*) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#10 0x00007fffed4f228e in ?? () from /usr/lib/x86_64-linux-gnu/libOgreMain.so.1.10.0\n#11 0x00007ffff7dea13a in call_init (l=&lt;optimized out&gt;, argc=argc@entry=1, argv=argv@entry=0x7fffffffece8, \n    env=env@entry=0x7fffffffecf8) at dl-init.c:78\n#12 0x00007ffff7dea223 in call_init (env=&lt;optimized out&gt;, argv=&lt;optimized out&gt;, argc=&lt;optimized out&gt;, \n    l=&lt;optimized out&gt;) at dl-init.c:36\n#13 _dl_init (main_map=0x7ffff7ffe1c8, argc=1, argv=0x7fffffffece8, env=0x7fffffffecf8) at dl-init.c:126\n#14 0x00007ffff7ddb30a in _dl_start_user () from /lib64/ld-linux-x86-64.so.2\n</pre></div>\n\n\n<p>While strace displays information about the system looking for a en_GB locale:</p>\n<div class=\"codehilite\"><pre><span></span>lock_getres(CLOCK_REALTIME, {0, 1})    = 0\nopen(&quot;/usr/lib/locale/locale-archive&quot;, O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=2854960, ...}) = 0\nmmap(NULL, 2854960, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fa6b5b19000\nclose(3)                                = 0\nopen(&quot;/usr/share/locale/locale.alias&quot;, O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=2570, ...}) = 0\nmmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fa6dbab9000\nread(3, &quot;# Locale name alias data base.\\n#&quot;..., 4096) = 2570\nread(3, &quot;&quot;, 4096)                       = 0\nclose(3)                                = 0\nmunmap(0x7fa6dbab9000, 4096)            = 0\nopen(&quot;/usr/lib/locale/en_GB.UTF-8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/lib/locale/en_GB.utf8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/lib/locale/en_GB/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/lib/locale/en.UTF-8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/lib/locale/en.utf8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/lib/locale/en/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/share/locale-langpack/en_GB.UTF-8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/share/locale-langpack/en_GB.utf8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/share/locale-langpack/en_GB/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/share/locale-langpack/en.UTF-8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/share/locale-langpack/en.utf8/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/share/locale-langpack/en/LC_CTYPE&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\n</pre></div>\n\n\n<p>My hypothesis is that we should be under the effects of <a data-is-external-link=\"true\" href=\"http://www.ogre3d.org/forums/viewtopic.php?f=2&amp;t=80132\" rel=\"nofollow\">this problem</a>. Official <a data-is-external-link=\"true\" href=\"https://ogre3d.atlassian.net/browse/OGRE-374\" rel=\"nofollow\">issue</a>.</p>", "type": "rendered"}, "assignee": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "state": "closed", "version": null, "edited_on": null, "created_on": "2015-05-14T18:12:10.630804+00:00", "milestone": null, "updated_on": "2018-03-19T21:43:37.834507+00:00", "type": "issue", "id": 91}