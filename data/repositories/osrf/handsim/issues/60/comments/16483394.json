{"links": {"self": {"href": "data/repositories/osrf/handsim/issues/60/comments/16483394.json"}, "html": {"href": "#!/osrf/handsim/issues/60#comment-16483394"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/handsim/issues/60.json"}}, "type": "issue", "id": 60, "repository": {"links": {"self": {"href": "data/repositories/osrf/handsim.json"}, "html": {"href": "#!/osrf/handsim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{9c7d89af-6eb6-40b1-9f69-da1ae9d129ce}ts=c_plus_plus"}}, "type": "repository", "name": "handsim", "full_name": "osrf/handsim", "uuid": "{9c7d89af-6eb6-40b1-9f69-da1ae9d129ce}"}, "title": "Add motor to mcp transmission"}, "content": {"raw": "According to conversation with JHU, transmission v2 is defined below:\n~~~\nIf motor angle < 10\n        MCP angle = motor angle\n        PIP angle = 0\n        DIP angle = 0\nElse \u00a0\n        MCP angle = (motor angle \u2013 10) * 90/(118-10)\n        PIP angle = (MCP angle \u2013 10) * 69/(90-10)\n        DIP angle = (MCP angle \u2013 10) * 67/(90-10)\nEnd\n~~~\n\nSecond block can be written as functions of motor angle only as\n~~~\n        MCP angle = (motor angle \u2013 10) * 90/(118-10)\n        PIP angle = (motor angle \u2013 10 \u2013 10*(118-10)/90) * 69/(90-10)*90/(118-10)\n        DIP angle = (motor angle \u2013 10 \u2013 10*(118-10)/90) * 67/(90-10)*90/(118-10)\n~~~\n\nHowever, to prevent MCP, PIP and DIP angle jump around motor angle of 10 deg, maybe the correct formulation should have been:\n\n~~~\nIf motor angle < 10\n        MCP angle = motor angle\n        PIP angle = 0\n        DIP angle = 0\nElse  \n        MCP angle = (motor angle \u2013 10) * 90/(118-10) + 10\n        PIP angle = (MCP angle \u2013 10) * 69/(90-10)\n        DIP angle = (MCP angle \u2013 10) * 67/(90-10)\nEnd\n~~~\n\nBased on above, a 2 stage transmission is proposed.\n\nExample transmission:\n~~~\n    <motor id=\"3\" name=\"motor_a\">\n      <powered_motor_joint>joint_33</powered_motor_joint>\n      <gear_ratio>399.0</gear_ratio>\n      <!-- per JHU requirements, transmission is applied in 2 stages,\n           for powered motor joint angle less than minimum of all gearbox offsets,\n           multiplier1 is used. Otherwise multiplier2 is used.\n    \n           For example:\n    \n             minOffset = min(0.15, 0.25) = 0.15\n             if (joint_33 < minOffset)\n               joint_55 = 100.0 * joint_33\n               joint_66 = 0.0 * joint_33\n             else\n               joint_55 = 1.5 * (joint_33 - minOffset)\n                        + 100.0 * minOffset\n               joint_66 = 10.5 * (joint_33 - minOffset)\n                        + 0.0 * minOffset\n      -->\n      <gearbox>\n        <joint>joint_55</joint>\n        <offset>0.15</offset>\n        <multiplier1>100.0</multiplier1>\n        <multiplier2>1.5</multiplier2>\n      </gearbox>\n      <gearbox>\n        <joint>joint_66</joint>\n        <offset>0.25</offset>\n        <multiplier1>0.0</multiplier1>\n        <multiplier2>10.5</multiplier2>\n      </gearbox>\n    </motor>\n~~~\n", "markup": "markdown", "html": "<p>According to conversation with JHU, transmission v2 is defined below:</p>\n<div class=\"codehilite\"><pre><span></span>If motor angle &lt; 10\n        MCP angle = motor angle\n        PIP angle = 0\n        DIP angle = 0\nElse \u00a0\n        MCP angle = (motor angle \u2013 10) * 90/(118-10)\n        PIP angle = (MCP angle \u2013 10) * 69/(90-10)\n        DIP angle = (MCP angle \u2013 10) * 67/(90-10)\nEnd\n</pre></div>\n\n\n<p>Second block can be written as functions of motor angle only as</p>\n<div class=\"codehilite\"><pre><span></span>        MCP angle = (motor angle \u2013 10) * 90/(118-10)\n        PIP angle = (motor angle \u2013 10 \u2013 10*(118-10)/90) * 69/(90-10)*90/(118-10)\n        DIP angle = (motor angle \u2013 10 \u2013 10*(118-10)/90) * 67/(90-10)*90/(118-10)\n</pre></div>\n\n\n<p>However, to prevent MCP, PIP and DIP angle jump around motor angle of 10 deg, maybe the correct formulation should have been:</p>\n<div class=\"codehilite\"><pre><span></span>If motor angle &lt; 10\n        MCP angle = motor angle\n        PIP angle = 0\n        DIP angle = 0\nElse  \n        MCP angle = (motor angle \u2013 10) * 90/(118-10) + 10\n        PIP angle = (MCP angle \u2013 10) * 69/(90-10)\n        DIP angle = (MCP angle \u2013 10) * 67/(90-10)\nEnd\n</pre></div>\n\n\n<p>Based on above, a 2 stage transmission is proposed.</p>\n<p>Example transmission:</p>\n<div class=\"codehilite\"><pre><span></span>    <span class=\"nt\">&lt;motor</span> <span class=\"na\">id=</span><span class=\"s\">&quot;3&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;motor_a&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;powered_motor_joint&gt;</span>joint_33<span class=\"nt\">&lt;/powered_motor_joint&gt;</span>\n      <span class=\"nt\">&lt;gear_ratio&gt;</span>399.0<span class=\"nt\">&lt;/gear_ratio&gt;</span>\n      <span class=\"c\">&lt;!-- per JHU requirements, transmission is applied in 2 stages,</span>\n<span class=\"c\">           for powered motor joint angle less than minimum of all gearbox offsets,</span>\n<span class=\"c\">           multiplier1 is used. Otherwise multiplier2 is used.</span>\n\n<span class=\"c\">           For example:</span>\n\n<span class=\"c\">             minOffset = min(0.15, 0.25) = 0.15</span>\n<span class=\"c\">             if (joint_33 &lt; minOffset)</span>\n<span class=\"c\">               joint_55 = 100.0 * joint_33</span>\n<span class=\"c\">               joint_66 = 0.0 * joint_33</span>\n<span class=\"c\">             else</span>\n<span class=\"c\">               joint_55 = 1.5 * (joint_33 - minOffset)</span>\n<span class=\"c\">                        + 100.0 * minOffset</span>\n<span class=\"c\">               joint_66 = 10.5 * (joint_33 - minOffset)</span>\n<span class=\"c\">                        + 0.0 * minOffset</span>\n<span class=\"c\">      --&gt;</span>\n      <span class=\"nt\">&lt;gearbox&gt;</span>\n        <span class=\"nt\">&lt;joint&gt;</span>joint_55<span class=\"nt\">&lt;/joint&gt;</span>\n        <span class=\"nt\">&lt;offset&gt;</span>0.15<span class=\"nt\">&lt;/offset&gt;</span>\n        <span class=\"nt\">&lt;multiplier1&gt;</span>100.0<span class=\"nt\">&lt;/multiplier1&gt;</span>\n        <span class=\"nt\">&lt;multiplier2&gt;</span>1.5<span class=\"nt\">&lt;/multiplier2&gt;</span>\n      <span class=\"nt\">&lt;/gearbox&gt;</span>\n      <span class=\"nt\">&lt;gearbox&gt;</span>\n        <span class=\"nt\">&lt;joint&gt;</span>joint_66<span class=\"nt\">&lt;/joint&gt;</span>\n        <span class=\"nt\">&lt;offset&gt;</span>0.25<span class=\"nt\">&lt;/offset&gt;</span>\n        <span class=\"nt\">&lt;multiplier1&gt;</span>0.0<span class=\"nt\">&lt;/multiplier1&gt;</span>\n        <span class=\"nt\">&lt;multiplier2&gt;</span>10.5<span class=\"nt\">&lt;/multiplier2&gt;</span>\n      <span class=\"nt\">&lt;/gearbox&gt;</span>\n    <span class=\"nt\">&lt;/motor&gt;</span>\n</pre></div>", "type": "rendered"}, "created_on": "2015-03-17T01:50:37.941136+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "updated_on": "2015-03-17T19:43:13.307275+00:00", "type": "issue_comment", "id": 16483394}